
#import <Foundation/Foundation.h>

NSString *StringFromCentralAnonDarkData(Byte *data);


//: 你领取了自己的红包
Byte themePerspectiveEvent[] = {49, 27, 79, 9, 239, 139, 245, 251, 126, 51, 12, 239, 56, 241, 213, 52, 222, 229, 51, 9, 213, 55, 214, 249, 52, 6, 0, 54, 233, 211, 54, 9, 241, 52, 219, 212, 33};

//: 你领取了
Byte viewPutKey[] = {2, 12, 79, 9, 111, 159, 143, 134, 153, 51, 12, 239, 56, 241, 213, 52, 222, 229, 51, 9, 213, 50};

//: 领取了你的红包，你的红包已被领完
Byte featureDestinationDevice[] = {49, 48, 69, 14, 134, 97, 62, 33, 36, 62, 90, 141, 79, 1, 46, 231, 203, 42, 212, 219, 41, 255, 203, 41, 2, 229, 44, 223, 201, 44, 255, 231, 42, 209, 202, 52, 1, 209, 41, 2, 229, 44, 223, 201, 44, 255, 231, 42, 209, 202, 42, 252, 247, 45, 231, 240, 46, 231, 203, 42, 243, 209, 190};

//: type
Byte k_leadingPreference[] = {87, 4, 78, 6, 56, 116, 194, 199, 190, 179, 28};

//: 你领取了自己的红包，你的红包已被领完
Byte viewCommunicationText[] = {59, 54, 38, 6, 120, 56, 10, 227, 198, 15, 200, 172, 11, 181, 188, 10, 224, 172, 14, 173, 208, 11, 221, 215, 13, 192, 170, 13, 224, 200, 11, 178, 171, 21, 226, 178, 10, 227, 198, 13, 192, 170, 13, 224, 200, 11, 178, 171, 11, 221, 216, 14, 200, 209, 15, 200, 172, 11, 212, 178, 88};

//: redPacketId
Byte appScenePlatform[] = {86, 11, 27, 5, 97, 141, 128, 127, 107, 124, 126, 134, 128, 143, 100, 127, 242};

//: 红包
Byte screenRelationText[] = {48, 6, 14, 9, 128, 65, 253, 81, 142, 245, 200, 176, 243, 154, 147, 70};

//: openPacketId
Byte colorMakeError[] = {55, 12, 3, 14, 98, 63, 138, 226, 171, 105, 196, 61, 200, 100, 114, 115, 104, 113, 83, 100, 102, 110, 104, 119, 76, 103, 248};

//: sendPacketId
Byte k_untilName[] = {94, 12, 62, 10, 122, 43, 233, 73, 47, 58, 177, 163, 172, 162, 142, 159, 161, 169, 163, 178, 135, 162, 62};

//: data
Byte commonRadarMessage[] = {72, 4, 64, 8, 129, 162, 186, 134, 164, 161, 180, 161, 45};

//: 领取了你的红包
Byte styleSupportBondPreference[] = {94, 21, 33, 14, 242, 86, 210, 62, 54, 225, 18, 243, 250, 181, 10, 195, 167, 6, 176, 183, 5, 219, 167, 5, 222, 193, 8, 187, 165, 8, 219, 195, 6, 173, 166, 35};

//: isGetDone
Byte viewSessionTimer[] = {36, 9, 53, 5, 158, 158, 168, 124, 154, 169, 121, 164, 163, 154, 25};

// __DEBUG__
// __CLOSE_PRINT__
//
//  YieldValidCollector.m
//  NIM
//
//  Created by chris on 2017/7/17.
//  Copyright © 2017年 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "YieldValidCollector.h"
#import "YieldValidCollector.h"
//: #import "ThemeSystemVividWhole.h"
#import "ThemeSystemVividWhole.h"
//: #import "SupremeStrongToLayer.h"
#import "SupremeStrongToLayer.h"
//: #import "NovelHillConverterInspector.h"
#import "NovelHillConverterInspector.h"

//: @interface YieldValidCollector()
@interface YieldValidCollector()

//: @property (nonatomic,weak) NIMMessage *message;
@property (nonatomic,weak) NIMMessage *steady;

//: @end
@end

//: @implementation YieldValidCollector
@implementation YieldValidCollector

//: - (CGSize)contentSize:(NIMMessage *)message cellWidth:(CGFloat)width{
- (CGSize)minLiberal:(NIMMessage *)message mediumBy:(CGFloat)width{
    //: self.message = message;
    self.steady = message;

    //: SupremeStrongToLayer *label = [[SupremeStrongToLayer alloc] initWithFrame:CGRectZero];
    SupremeStrongToLayer *label = [[SupremeStrongToLayer alloc] initWithFrame:CGRectZero];
    //: label.font = [UIFont systemFontOfSize:10];
    label.font = [UIFont systemFontOfSize:10];

    //: CGFloat messageWidth = width;
    CGFloat messageWidth = width;

    //: [label appendText:self.formatedMessage];
    [label roundHistory:self.barMessage];
    //: label.autoDetectLinks = NO;
    label.maturityDateClose = NO;
    //: label.numberOfLines = 0;
    label.roundCounterval = 0;

    //: CGFloat padding = [TowerTinyGranularLarge sharedKit].config.maxNotificationTipPadding;
    CGFloat padding = [TowerTinyGranularLarge basicDragKit].arcSolarStrength.dualFlesh;
    //: CGSize size = [label sizeThatFits:CGSizeMake(width - 2 * padding, 1.7976931348623157e+308)];
    CGSize size = [label sizeThatFits:CGSizeMake(width - 2 * padding, 1.7976931348623157e+308)];
    //: CGFloat cellPadding = 11.f;
    CGFloat cellPadding = 11.f;
    //: CGSize contentSize = CGSizeMake(messageWidth, size.height + 2 * cellPadding);;
    CGSize contentSize = CGSizeMake(messageWidth, size.height + 2 * cellPadding);;
    //: return contentSize;
    return contentSize;
}


//: - (NSString *)encodeAttachment {
- (NSString *)encodeAttachment {

    //: NSDictionary *dictContent = @{
    NSDictionary *dictContent = @{
                                  //: @"sendPacketId" : self.sendPacketId,
                                  StringFromCentralAnonDarkData(k_untilName) : self.dominate,
                                  //: @"openPacketId" : self.openPacketId,
                                  StringFromCentralAnonDarkData(colorMakeError) : self.lactiferousDuct,
                                  //: @"redPacketId" : self.packetId,
                                  StringFromCentralAnonDarkData(appScenePlatform) : self.north,
                                  //: @"isGetDone" : self.isGetDone,
                                  StringFromCentralAnonDarkData(viewSessionTimer) : self.instanceWhite,
                                  //: };
                                  };
    //: NSDictionary *dict = @{@"type": @(FocalUnderConfigureDisplayTypeRedPacketTip), @"data": dictContent};
    NSDictionary *dict = @{StringFromCentralAnonDarkData(k_leadingPreference): @(FocalUnderConfigureDisplayTypeRedPacketTip), StringFromCentralAnonDarkData(commonRadarMessage): dictContent};

    //: NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dict
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dict
                                                       //: options:0
                                                       options:0
                                                         //: error:nil];
                                                         error:nil];

    //: return [[NSString alloc] initWithData:jsonData
    return [[NSString alloc] initWithData:jsonData
                                 //: encoding:NSUTF8StringEncoding];
                                 encoding:NSUTF8StringEncoding];
}


//: - (NSString *)formatedMessage{
- (NSString *)barMessage{
    //: NSString * showContent;
    NSString * showContent;
    //: NSString * currentUserId = [[NIMSDK sharedSDK].loginManager currentAccount];
    NSString * currentUserId = [[NIMSDK sharedSDK].loginManager currentAccount];
    // 领取别人的红包
    //: NovelHillConverterInspector *option = [[NovelHillConverterInspector alloc] init];
    NovelHillConverterInspector *option = [[NovelHillConverterInspector alloc] init];
    //: option.message = self.message;
    option.fragmentProud = self.steady;

    //: if ([currentUserId isEqualToString:self.sendPacketId] && [currentUserId isEqualToString:self.openPacketId])
    if ([currentUserId isEqualToString:self.dominate] && [currentUserId isEqualToString:self.lactiferousDuct])
    {
        //: if ([self.isGetDone boolValue])
        if ([self.instanceWhite boolValue])
        {
            //: showContent = @"你领取了自己的红包，你的红包已被领完".user_localized;
            showContent = StringFromCentralAnonDarkData(viewCommunicationText).underMethod;
        }
        //: else
        else
        {
            //: showContent = @"你领取了自己的红包".user_localized;
            showContent = StringFromCentralAnonDarkData(themePerspectiveEvent).underMethod;
        }
    }
    //: else if ([currentUserId isEqualToString:self.openPacketId])
    else if ([currentUserId isEqualToString:self.lactiferousDuct])
    {
        //: RoundReportSheet * sendUserInfo = [[TowerTinyGranularLarge sharedKit] infoByUser:self.sendPacketId option:option];
        RoundReportSheet * sendUserInfo = [[TowerTinyGranularLarge basicDragKit] screenOption:self.dominate byProduct:option];
        //: NSString * name = sendUserInfo.showName;
        NSString * name = sendUserInfo.showNumberro;
        //: showContent = [NSString stringWithFormat:@"%@%@%@",
        showContent = [NSString stringWithFormat:@"%@%@%@",
                       //: @"你领取了".user_localized,
                       StringFromCentralAnonDarkData(viewPutKey).underMethod,
                       //: name,
                       name,
                       //: @"红包".user_localized];
                       StringFromCentralAnonDarkData(screenRelationText).underMethod];
    }

    // 他人领取你的红包
    //: else if ([currentUserId isEqualToString:self.sendPacketId])
    else if ([currentUserId isEqualToString:self.dominate])
    {
        //: RoundReportSheet * openUserInfo = [[TowerTinyGranularLarge sharedKit] infoByUser:self.openPacketId option:option];
        RoundReportSheet * openUserInfo = [[TowerTinyGranularLarge basicDragKit] screenOption:self.lactiferousDuct byProduct:option];
        //: NSString * name = openUserInfo.showName;
        NSString * name = openUserInfo.showNumberro;

        //: if ([self.isGetDone boolValue])
        if ([self.instanceWhite boolValue])
        {
            //: showContent = [NSString stringWithFormat:@"%@%@",
            showContent = [NSString stringWithFormat:@"%@%@",
                           //: name,
                           name,
                           //: @"领取了你的红包，你的红包已被领完".user_localized];
                           StringFromCentralAnonDarkData(featureDestinationDevice).underMethod];
        }
        //: else
        else
        {
            //: showContent = [NSString stringWithFormat:@"%@%@",
            showContent = [NSString stringWithFormat:@"%@%@",
                           //: name,
                           name,
                           //: @"领取了你的红包".user_localized];
                           StringFromCentralAnonDarkData(styleSupportBondPreference).underMethod];
        }
    }

    //: return [NSString stringWithFormat:@"  %@",showContent];
    return [NSString stringWithFormat:@"  %@",showContent];
}

//: - (BOOL)canBeRevoked
- (BOOL)jungle
{
    //: return NO;
    return NO;
}

//: - (NSString *)cellContent:(NIMMessage *)message
- (NSString *)jungle:(NIMMessage *)message
{
    //: return @"SynchronizerFontVictoriousUnderUniversal";
    return @"SynchronizerFontVictoriousUnderUniversal";
}

//: - (BOOL)canBeForwarded
- (BOOL)be
{
    //: return NO;
    return NO;
}

//: - (UIEdgeInsets)contentViewInsets:(NIMMessage *)message
- (UIEdgeInsets)bold:(NIMMessage *)message
{
    //: return UIEdgeInsetsZero;
    return UIEdgeInsetsZero;
}


//: @end
@end

Byte * CentralAnonDarkDataToCache(Byte *data) {
    int bondLikely = data[0];
    int recordPackage = data[1];
    Byte unspeakable = data[2];
    int turnWater = data[3];
    if (!bondLikely) return data + turnWater;
    for (int i = turnWater; i < turnWater + recordPackage; i++) {
        int value = data[i] - unspeakable;
        if (value < 0) {
            value += 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[turnWater + recordPackage] = 0;
    return data + turnWater;
}

NSString *StringFromCentralAnonDarkData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)CentralAnonDarkDataToCache(data)];
}
